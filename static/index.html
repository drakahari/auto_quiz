<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Training & Practice Center</title>
<link rel="stylesheet" href="/static/style.css">
<link rel="icon" href="/static/favicon.ico">

<script>
fetch("/config/portal.json")
  .then(r => r.json())
  .then(cfg => {
      if (cfg.background_image) {
          document.documentElement.style.setProperty(
              "--portal-bg",
              `url(${cfg.background_image})`
          );
      }
  });
</script>
</head>

<body>

<div class="container">

    <h1 class="hero-title">
        {{ portal_title }}<br>
        <span style="font-size:20px;opacity:.85">
            Build â€¢ Study â€¢ Test â€¢ Improve
        </span>
    </h1>

    <div class="card">

        <h2 style="text-align:center">Welcome!</h2>
        <p style="text-align:center">
            This platform allows you to upload custom question banks,
            generate quizzes, take exams, track performance, and review progress.
        </p>

        <div class="portal-grid">

            <div class="portal-card" onclick="location.href='/library'">
                <h2>ğŸ“š View Quiz Library</h2>
                <p>Browse and launch available quizzes.</p>
            </div>

            <div class="portal-card" onclick="location.href='/upload'">
                <h2>ğŸ“¤ Upload or Build Quiz</h2>
                <p>Create or import a new quiz.</p>
            </div>

            <div class="portal-card" onclick="location.href='/history.html'">
                <h2>ğŸ“œ Test History</h2>
                <p>Review your completed attempts.</p>
            </div>

            <div class="portal-card" onclick="location.href='/dashboard.html'">
                <h2>ğŸ“Š Analytics Dashboard</h2>
                <p>See trends, improvements, and insights.</p>
            </div>

            <div class="portal-card settings-card" onclick="location.href='/settings'">
                <h2>âš™ï¸ Portal Settings</h2>
                <p>Advanced options & maintenance tools.</p>
            </div>

            <div class="portal-card settings-card" onclick="location.href='/help'">
                <h2>â“ Help & Documentation</h2>
                <p>Learn how to use DLMS and its features.</p>
            </div>

            <!-- âœ… NEW: Shutdown card -->
            <div class="portal-card settings-card"
                 id="shutdownBtn"
                 style="border:2px solid #b30000">
                <h2>ğŸ›‘ Shutdown DLMS</h2>
                <p>Safely stop the application</p>
            </div>

        </div>

    </div>

</div>

<!-- âœ… Shutdown handler (known working pattern) -->
<script>
document.getElementById("shutdownBtn").addEventListener("click", async () => {

    if (!confirm(
        "ğŸ›‘ SHUTDOWN DLMS ğŸ›‘\n\n" +
        "This will stop the application.\n\n" +
        "You will need to restart it manually.\n\n" +
        "Continue?"
    )) return;

    try {
        const res = await fetch("/api/shutdown", { method: "POST" });
        const data = await res.json();

        if (data.status === "ok") {
            alert("DLMS is shutting down.");
        } else {
            throw new Error();
        }

    } catch (err) {
        alert("âŒ Failed to shut down DLMS.");
    }
});
</script>

</body>
</html>
